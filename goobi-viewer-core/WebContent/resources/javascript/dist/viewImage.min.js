/*!
 * This file is part of the Goobi viewer - a content presentation and management application for digitized objects.
 *
 * Visit these websites for more information.
 * - http://www.intranda.com
 * - http://digiverso.com
 *
 * This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free
 * Software Foundation; either version 2 of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program. If not, see <http://www.gnu.org/licenses/>.
 */
var viewImage=function(){"use strict";var n,a,i={},s=null,l={global:{divId:"map",zoomSlider:".zoom-slider",zoomSliderHandle:".zoom-slider-handle",overlayGroups:[{name:"searchHighlighting",styleClass:"coords-highlighting",interactive:!1},{name:"ugc",styleClass:"ugcBox",interactive:!0}],zoomSpeed:1.25,maxZoomLevel:20,minZoomLevel:1,imageControlsActive:!0,visibilityRatio:.4,loadImageTimeout:6e5,maxParallelImageLoads:1,adaptContainerHeight:!1,footerHeight:50,rememberZoom:!1,rememberRotation:!1},image:{},getOverlayGroup:function(e){for(var t=l.global.overlayGroups,o=0;o<t.length;o++){var r=t[o];if(r.name===e)return r}},getCoordinates:function(e){var t=l.image.highlightCoords;if(t)for(var o=0;o<t.length;o++){var r=t[o];if(r.name===e)return r}}};function e(e){if(0<l.global.footerHeight){var t=l.global.footerHeight,o=new OpenSeadragon.Point(0,a.height()-t),r=new OpenSeadragon.Point(a.width(),t);n||(n=i.viewer.drawer.context.canvas.width/i.viewer.drawer.context.canvas.clientWidth),1!=n&&(o=o.times(n),r=r.times(n)),i.viewer.drawer.context.drawImage(s,o.x,o.y,r.x,r.y)}}return i={viewer:null,init:function(e){$.extend(!0,l,e),l.image.mimeType=l.image.mimeType.replace("jpeg","jpg"),a=$("#"+l.global.divId);var t=l.image.tileSource;"string"==typeof t&&t.startsWith("[")?t=JSON.parse(t):$.isArray(t)||(t=[t]);for(var o=[],r=0;r<t.length;r++){var n=t[r],i=viewImage.createTileSource(n);o.push(i)}return Q.all(o).then(function(e){for(var t=Number.MAX_VALUE,o=Number.MAX_VALUE,r=Number.MAX_VALUE,n=0;n<e.length;n++){var i=e[n];t=Math.min(t,i.width),o=Math.min(o,i.height),r=Math.min(r,i.aspectRatio)}for(var a=0,s=0;s<e.length;s++){i=e[s];e[s]={tileSource:i,width:i.aspectRatio/r,x:a,y:0},a+=e[s].width}return viewImage.loadImage(e)})},loadImage:function(e){i.loadFooter(),i.viewer=new OpenSeadragon({immediateRender:!1,visibilityRatio:l.global.visibilityRatio,sequenceMode:!1,id:l.global.divId,controlsEnabled:!1,prefixUrl:"/openseadragon-bin/images/",zoomPerClick:1,maxZoomLevel:l.global.maxZoomLevel,minZoomLevel:l.global.minZoomLevel,zoomPerScroll:l.global.zoomSpeed,mouseNavEnabled:1<l.global.zoomSpeed,showNavigationControl:!1,showZoomControl:!1,showHomeControl:!1,showFullPageControl:!0,timeout:l.global.loadImageTimeout,tileSources:e,blendTime:.5,alwaysBlend:!1,imageLoaderLimit:l.global.maxParallelImageLoads,viewportMargins:{top:0,left:0,right:0,bottom:l.global.footerHeight}});var t,o,r,n=Q.defer();return i.observables=(t=window,o=i.viewer,(r={}).viewerOpen=Rx.Observable.create(function(t){o.addOnceHandler("open",function(e){return e.osState="open",Number.isNaN(e.eventSource.viewport.getHomeBounds().x)?t.onError("Unknow error loading image from ",l.image.tileSource):t.onNext(e)}),o.addOnceHandler("open-failed",function(e){return e.osState="open-failed",console.log("Failed to open openseadragon "),t.onError(e)})}),r.firstTileLoaded=Rx.Observable.create(function(t){o.addOnceHandler("tile-loaded",function(e){return e.osState="tile-loaded",t.onNext(e)}),o.addOnceHandler("tile-load-failed",function(e){return e.osState="tile-load-failed",console.log("Failed to load tile"),t.onError(e)})}),r.viewerZoom=Rx.Observable.create(function(t){o.addHandler("zoom",function(e){return t.onNext(e)})}),r.animationComplete=Rx.Observable.create(function(t){o.addHandler("animation-finish",function(e){return t.onNext(e)})}),r.viewportUpdate=Rx.Observable.create(function(t){o.addHandler("update-viewport",function(e){return t.onNext(e)})}),r.animation=Rx.Observable.create(function(t){o.addHandler("animation",function(e){return t.onNext(e)})}),r.viewerRotate=Rx.Observable.create(function(t){o.addHandler("rotate",function(e){return e.osState="rotate",t.onNext(e)})}),r.canvasResize=Rx.Observable.create(function(t){o.addHandler("resize",function(e){return e.osState="resize",t.onNext(e)})}),r.windowResize=Rx.Observable.fromEvent(t,"resize").map(function(e){return e.osState="window resize",e}),r.overlayRemove=Rx.Observable.create(function(t){o.addHandler("remove-overlay",function(e){return t.onNext(e)})}),r.overlayUpdate=Rx.Observable.create(function(t){o.addHandler("update-overlay",function(e){return t.onNext(e)})}),r.levelUpdate=Rx.Observable.create(function(t){o.addHandler("update-level",function(e){return t.onNext(e)})}),r.redrawRequired=r.viewerOpen.merge(r.viewerRotate.merge(r.canvasResize).debounce(10)).map(function(e){var t={};return i.controls&&(t=i.controls.getLocation()),"open"===e.osState&&(t.zoom=i.viewer.viewport.getHomeZoom(),l.image.location&&(t=l.image.location)),e.targetLocation=t,e}).publish(),r),i.observables.viewerOpen.subscribe(function(e,t){n.resolve(i)},function(e){n.reject(e)}),i.observables.redrawRequired.subscribe(function(e){i.redraw()}),i.controls&&i.controls.init(l),i.zoomSlider&&i.zoomSlider.init(l),i.overlays&&i.overlays.init(l),i.drawRect&&i.drawRect.init(),i.transformRect&&i.transformRect.init(),i.observables.redrawRequired.connect(),n.promise},getObservables:function(){return console.log("Observables = ",i.observables),i.observables},hasFooter:function(){return null!=s},getConfig:function(){return l},loadFooter:function(){l.image.baseFooterUrl&&0<l.global.footerHeight&&((s=new Image).src=l.image.baseFooterUrl.replace("{width}",Math.round(a.width())).replace("{height}",Math.round(l.global.footerHeight)),s.src=l.image.baseFooterUrl.replace("/full/max/","/full/!"+Math.round(a.width())+","+Math.round(l.global.footerHeight)+"/"),s.onload=function(){i.drawFooter()})},drawFooter:function(){i.viewer&&e(),i.viewer.removeHandler("update-viewport",e),i.viewer.addHandler("update-viewport",e)},getOverlayGroup:function(e){return l.getOverlayGroup(e)},getHighlightCoordinates:function(e){return l.getCoordinates(e)},createPyramid:function(o){var r=l.image.mimeType;r=(r=r.replace("image/","")).replace("jpeg","jpg").replace("tiff","tif");var e,n=[];return Array.isArray(o)?(o.forEach(function(e){e.mimetype=l.image.mimeType}),e=new OpenSeadragon.LegacyTileSource(o)):o.sizes?(o.sizes.forEach(function(e){var t={mimetype:l.image.mimeType,url:o["@id"].replace("/info.json","")+"/full/"+e.width+",/0/default."+r,width:o.width,height:o.height};n.push(t)}),e=new OpenSeadragon.LegacyTileSource(n)):e=new OpenSeadragon.ImageTileSource({url:o["@id"].replace("/info.json","")+"/full/full/0/default."+r,crossOriginPolicy:"Anonymous",buildPyramid:!1}),e},getSizes:function(){return i.sizes},addImage:function(e,t,o){i.viewer&&i.viewer.addTiledImage({tileSource:{type:"legacy-image-pyramid",levels:[{url:e,height:o,width:t}]},x:0,y:1.6,width:1})},getImageInfo:function(){return i.viewer?i.viewer.tileSources:null},getScaleToOriginalSize:function(e){return 1},scaleToOriginalSize:function(e,t){return e},scaleToImageSize:function(e,t){return e},close:function(){i.viewer&&i.viewer.destroy()},redraw:function(){i.controls&&i.controls.setPanning(!0),function(e){0;e.sizes=new viewImage.Measures(e),l.global.adaptContainerHeight&&e.sizes.resizeCanvas();null!=e.viewer&&e.viewer.viewport.setMargins({bottom:e.sizes.footerHeight+e.sizes.calculateExcessHeight()});0}(i)},setImageSizes:function(e,t){if(t){t.replace(/[\{\}]/,""),t=JSON.parse(t);var o=[];t.forEach(function(e){o.push({width:parseInt(e),height:parseInt(e)})}),0<o.length?e.sizes=o:delete e.sizes}},setTileSizes:function(e,o){if(o){var t=viewImage.getConfig().global.tileSizes.replace(/(\d+)/,'"$1"').replace("=",":"),r=(o=JSON.parse(t),[]);Object.keys(o).forEach(function(e){var t=o[e];r.push({width:parseInt(e),height:parseInt(e),scaleFactors:t})}),e.tiles=r}},onFirstTileLoaded:function(){var t=Q.defer();return viewImage.observables?viewImage.observables.firstTileLoaded.subscribe(function(e){t.resolve(e)},function(e){t.reject(e)}):t.reject("No observables defined"),t.promise},createTileSource:function(e){var t=Q.defer();return viewImage.tileSourceResolver.resolveAsJson(e).then(function(e){var t;return viewImage.setImageSizes(e,l.global.imageSizes),viewImage.setTileSizes(e,l.global.tileSizes),e.tiles&&0<e.tiles.length?t=new OpenSeadragon.IIIFTileSource(e):(console.log("tiles? ",e.tiles),t=i.createPyramid(e)),t},function(e){if(viewImage.tileSourceResolver.isURI(l.image.tileSource)){0;var t=new OpenSeadragon.ImageTileSource({url:l.image.tileSource,buildPyramid:!0,crossOriginPolicy:!1});return t}var o="Failed to load tilesource from "+t;return Q.reject(o)}).then(function(e){t.resolve(e)}).catch(function(e){t.reject(e)}),t.promise}}}(jQuery,OpenSeadragon);String.prototype.startsWith||(String.prototype.startsWith=function(e){return 0===this.substring(0,e.length).localeCompare(e)}),String.prototype.endsWith||(String.prototype.endsWith=function(e){return 0===this.substring(this.length-e.length,this.length).localeCompare(e)}),Array.prototype.find||(Array.prototype.find=function(e){for(var t=0;t<this.length;t++){var o=this[t];if(e(o))return o}}),Number.isNaN||(Number.isNaN=function(e){return e!=e});viewImage=function(i){"use strict";var a={},s={global:{sliderDilation:12}};return i.zoomSlider={init:function(e){$.extend(!0,s,e),$(s.global.zoomSlider)&&(i.zoomSlider.addZoomSlider(s.global.zoomSlider),i.viewer.addHandler("zoom",function(e){i.zoomSlider.buttonToZoom(e.zoom)}))},buttonToMouse:function(e){var t=a.$button.width()/2,o=e-t;o<0&&(o=0),o+2*t>a.absoluteWidth&&(o=a.absoluteWidth-2*t),a.$button.css({left:o});var r=(a.buttonPosition=o)/(a.absoluteWidth-2*t);r=1/s.global.sliderDilation*Math.tan(Math.atan(s.global.sliderDilation)*r);var n=i.viewer.viewport.getMinZoom()+(i.viewer.viewport.getMaxZoom()-i.viewer.viewport.getMinZoom())*r;i.controls.zoomTo(n)},buttonToZoom:function(e){if(a&&i.viewer.viewport){var t=(e-i.viewer.viewport.getMinZoom())/(i.viewer.viewport.getMaxZoom()-i.viewer.viewport.getMinZoom()),o=(t=1/Math.atan(s.global.sliderDilation)*Math.atan(s.global.sliderDilation*t))*(a.absoluteWidth-a.$button.width());Math.abs(i.viewer.viewport.getMaxZoom()-e)<1e-10&&(o=a.absoluteWidth-a.$button.width()),o<0&&(o=0),a.$button.css({left:o}),a.buttonPosition=o}},zoomSliderMouseUp:function(){a.mousedown=!1},zoomSliderMouseMove:function(e){if(a.mousedown){var t=$(this).offset(),o=e.pageX-t.left;i.zoomSlider.buttonToMouse(o)}},zoomSliderMouseDown:function(e){a.mousedown=!0;var t=$(this).offset(),o=e.pageX-t.left;i.zoomSlider.buttonToMouse(o)},buttonMouseDown:function(){return!(a.mousedown=!0)},addZoomSlider:function(e){a.$element=$(e),a.$button=a.$element.children(s.global.zoomSliderHandle),a.buttonPosition=0,a.absoluteWidth=a.$element.innerWidth(),a.mousedown=!1,a.$button.on("mousedown",i.zoomSlider.buttonMouseDown),a.$element.click(i.zoomSlider._zoomSliderClick),a.$element.mousedown(i.zoomSlider.zoomSliderMouseDown),a.$element.mousemove(i.zoomSlider.zoomSliderMouseMove),$(document).on("mouseup",i.zoomSlider.zoomSliderMouseUp)}},i}((viewImage=function(l){"use strict";var i="default",o="transforming",a=!1,s=!1,r=null,c="",u=null;function e(e){if(!s&&a){var t=l.viewer.viewport.viewerElementToViewportCoordinates(e.position);t=l.overlays.getRotated(t);var o=l.overlays.getDrawingOverlay().rect,r=(l.overlays.getDrawingOverlay().element,l.viewer.element),n=h(o,t,.004);return n||(n=f(o,t,.004)),!n&&l.overlays.contains(o,t,0)&&(n=l.transformRect.hitAreas.CENTER),n?$(r).css({cursor:l.transformRect.hitAreas.getCursor(n)}):$(r).css({cursor:i}),e.preventDefaultAction=!0}}function t(e){if(a){if(!l.overlays.getDrawingOverlay())return!1;var t=l.overlays.getDrawingOverlay().rect,o=l.overlays.getDrawingOverlay().element,r=l.viewer.viewport.viewerElementToViewportCoordinates(e.position),n=h(t,r=l.overlays.getRotated(r),.004);return n||(n=f(t,r,.004)),!n&&l.overlays.contains(t,r,0)&&(n=l.transformRect.hitAreas.CENTER),n&&($(o).tooltip("destroy"),u=r),c=n,e.preventDefaultAction=!0}}function n(e){if(s){var t=l.viewer.viewport.viewerElementToViewportCoordinates(e.position);t=l.overlays.getRotated(t);var o,r,n=l.overlays.getDrawingOverlay().rect;if(c===l.transformRect.hitAreas.TOPLEFT)o=new OpenSeadragon.Point(Math.min(t.x,n.getBottomRight().x),Math.min(t.y,n.getBottomRight().y)),r=n.getBottomRight();else if(c===l.transformRect.hitAreas.TOPRIGHT)o=new OpenSeadragon.Point(n.getTopLeft().x,Math.min(t.y,n.getBottomRight().y)),r=new OpenSeadragon.Point(Math.max(t.x,n.getTopLeft().x),n.getBottomRight().y);else if(c===l.transformRect.hitAreas.BOTTOMLEFT)o=new OpenSeadragon.Point(Math.min(t.x,n.getBottomRight().x),n.getTopLeft().y),r=new OpenSeadragon.Point(n.getBottomRight().x,Math.max(t.y,n.getTopLeft().y));else if(c===l.transformRect.hitAreas.BOTTOMRIGHT)o=n.getTopLeft(),r=new OpenSeadragon.Point(Math.max(t.x,n.getTopLeft().x),Math.max(t.y,n.getTopLeft().y));else if(c===l.transformRect.hitAreas.LEFT)o=new OpenSeadragon.Point(Math.min(t.x,n.getBottomRight().x),n.getTopLeft().y),r=n.getBottomRight();else if(c===l.transformRect.hitAreas.RIGHT)o=n.getTopLeft(),r=new OpenSeadragon.Point(Math.max(t.x,n.getTopLeft().x),n.getBottomRight().y);else if(c===l.transformRect.hitAreas.TOP)o=new OpenSeadragon.Point(n.getTopLeft().x,Math.min(t.y,n.getBottomRight().y)),r=n.getBottomRight();else if(c===l.transformRect.hitAreas.BOTTOM)o=n.getTopLeft(),r=new OpenSeadragon.Point(n.getBottomRight().x,Math.max(t.y,n.getTopLeft().y));else if(c===l.transformRect.hitAreas.CENTER&&u){var i=u.x-t.x,a=u.y-t.y;n.x-=i,n.y-=a,u=t}return o&&r&&(n.x=o.x,n.y=o.y,n.width=r.x-o.x,n.height=r.y-o.y),l.viewer.updateOverlay(l.overlays.getDrawingOverlay().element,n,0),e.preventDefaultAction=!0}if(c)return s=!0,e.preventDefaultAction=!0}function g(e){if(a)return s&&r&&r(l.overlays.getDrawingOverlay()),s=!1,l.overlays.getDrawingOverlay()&&$(l.overlays.getDrawingOverlay().element).tooltip(),c="",u=null,e.preventDefaultAction=!0}function v(e){if(s)return s=!1,e.preventDefaultAction=!0}function d(e){if(s)return e.preventDefaultAction=!0}function f(e,t,o){var r=y(t,e.getTopLeft(),e.getBottomLeft()),n=y(t,e.getBottomLeft(),e.getBottomRight()),i=y(t,e.getTopRight(),e.getBottomRight()),a=y(t,e.getTopLeft(),e.getTopRight()),s=Math.min(r,Math.min(i,Math.min(a,n)));if(s<=o){if(r===s)return l.transformRect.hitAreas.LEFT;if(i===s)return l.transformRect.hitAreas.RIGHT;if(a===s)return l.transformRect.hitAreas.TOP;if(n===s)return l.transformRect.hitAreas.BOTTOM}return""}function h(e,t,o){var r=w(t,e.getTopLeft()),n=w(t,e.getBottomLeft()),i=w(t,e.getTopRight()),a=w(t,e.getBottomRight()),s=Math.min(r,Math.min(i,Math.min(n,a)));if(s<=o){if(r===s)return l.transformRect.hitAreas.TOPLEFT;if(i===s)return l.transformRect.hitAreas.TOPRIGHT;if(n===s)return l.transformRect.hitAreas.BOTTOMLEFT;if(a===s)return l.transformRect.hitAreas.BOTTOMRIGHT}return""}function m(e){return e*e}function p(e,t){return m(e.x-t.x)+m(e.y-t.y)}function w(e,t){return Math.sqrt(p(e,t))}function y(e,t,o){return Math.sqrt(function(e,t,o){var r=p(t,o);if(0==r)return p(e,t);var n=((e.x-t.x)*(o.x-t.x)+(e.y-t.y)*(o.y-t.y))/r;return p(e,n<0?t:1<n?o:{x:t.x+n*(o.x-t.x),y:t.y+n*(o.y-t.y)})}(e,t,o))}return l.transformRect={init:function(){l.viewer.addViewerInputHook({hooks:[{tracker:"viewer",handler:"clickHandler",hookHandler:d},{tracker:"viewer",handler:"dragHandler",hookHandler:n},{tracker:"viewer",handler:"pressHandler",hookHandler:t},{tracker:"viewer",handler:"dragEndHandler",hookHandler:v},{tracker:"viewer",handler:"releaseHandler",hookHandler:g},{tracker:"viewer",handler:"moveHandler",hookHandler:e}]})},startDrawing:function(e,t){l.overlays.setDrawingOverlay(e),a=!0,e.group,r=t,$(e.element).addClass(o)},endDrawing:function(){r=null,a=s=!1;var e=l.overlays.getDrawingOverlay();null!=e&&($(e.element).removeClass(o),$(e.element).css({cursor:i}))},isActive:function(){return a},hitAreas:{TOP:"t",BOTTOM:"b",RIGHT:"r",LEFT:"l",TOPLEFT:"tl",TOPRIGHT:"tr",BOTTOMLEFT:"bl",BOTTOMRIGHT:"br",CENTER:"c",isCorner:function(e){return e===this.TOPRIGHT||e===this.TOPLEFT||e===this.BOTTOMLEFT||e===this.BOTTOMRIGHT},isEdge:function(e){return e===this.TOP||e===this.BOTTOM||e===this.LEFT||e===this.RIGHT},getCursor:function(e){var t=l.viewer.viewport.getRotation()%180==90;return e===this.TOPLEFT||e===this.BOTTOMRIGHT?t?"nesw-resize":"nwse-resize":e===this.TOPRIGHT||e===this.BOTTOMLEFT?t?"nwse-resize":"nesw-resize":e===this.TOP||e===this.BOTTOM?t?"ew-resize":"ns-resize":e===this.RIGHT||e===this.LEFT?t?"ns-resize":"ew-resize":e===this.CENTER?"move":i}}},l}((viewImage=function(n){"use strict";return n.tileSourceResolver={resolveAsJsonOrURI:function(e){var t=Q.defer();return this.isJson(e)?t.resolve(e):this.isStringifiedJson(e)?t.resolve(JSON.parse(e)):t.resolve(e),t.promise},resolveAsJson:function(e){var t=Q.defer();if(this.isURI(e)){if(this.isJsonURI(e))return this.loadJsonFromURL(e);t.reject("Url does not lead to a json object")}else if("string"==typeof e)try{var o=JSON.parse(e);t.resolve(o)}catch(e){t.reject("String does not contain valid json: "+e)}else"object"==typeof e?t.resolve(e):t.reject("Neither a url nor a json object");return t.promise},loadJsonFromURL:function(e){var t=Q.defer();return this.isJsonURI(e)?OpenSeadragon.makeAjaxRequest(e,function(e){try{t.resolve(JSON.parse(e.responseText))}catch(e){t.reject(e)}},function(e){t.reject(e)}):t.reject("Not a json uri: "+e),t.promise},loadIfJsonURL:function(r){return Q.promise(function(t,o){if(n.tileSourceResolver.isURI(r)){var e={url:decodeURI(r),type:"GET",dataType:"JSON",async:!0,crossDomain:!0,accepts:{application_json:"application/json",application_jsonLd:"application/ld+json",text_json:"text/json",text_jsonLd:"text/ld+json"}};Q($.ajax(e)).then(function(e){t(e)}).fail(function(e){o("Failed to retrieve json from "+r)}),setTimeout(function(){o("Timeout after 10s")},1e4)}else o("Not a uri: "+r)})},isJsonURI:function(e){if(this.isURI(e)){var t=e.replace(/\?.*/,"");return t.endsWith("/")&&(t=t.substring(0,t.length-1)),t.toLowerCase().endsWith(".json")}return!1},isURI:function(e){return!(!e||"string"!=typeof e||!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("file:/")))},isStringifiedJson:function(e){if(e&&"string"==typeof e)try{var t=JSON.parse(e);return this.isJson(t)}catch(e){return!1}return!1},isJson:function(e){return e&&"object"==typeof e}},n}((viewImage=function(e){"use strict";var t=null,i={navSelector:".reading-mode__navigation",viewSelector:"#contentView",imageContainerSelector:".reading-mode__content-view-image",imageSelector:"#readingModeImage",sidebarSelector:"#contentSidebar",sidebarToggleButton:".reading-mode__content-sidebar-toggle",sidebarInnerSelector:".reading-mode__content-sidebar-inner",sidebarTabsSelector:".reading-mode__content-sidebar-tabs",sidebarTabContentSelector:".tab-content",sidebarTocWrapperSelector:".widget-toc-elem-wrapp",sidebarStatus:"",useTabs:!0,useAccordeon:!1,msg:{}};function o(){var e=$(window).outerHeight(),t=$(i.navSelector).outerHeight(),o=e-t;$(i.viewSelector).css("height",o),$(i.imageSelector).css("height",o),$(i.sidebarSelector).css("height",o),$(i.sidebarInnerSelector).css("height",o)}function r(){var e=$(window).outerHeight(),t=e-$(i.navSelector).outerHeight(),o=$(i.sidebarTabsSelector).position(),r=t-o.top-15,n=$(".nav-tabs").outerHeight();768<e&&($(i.sidebarTabsSelector).css("height",r),$(i.sidebarTabContentSelector).css("height",r-n),$(i.sidebarTocWrapperSelector).css("min-height",r-n))}function n(){var e=$(i.viewSelector).outerHeight()/2;$(i.sidebarToggleButton).css("top",e)}return e.readingMode={init:function(e){if($.extend(!0,i,e),!viewerJS.helper.checkLocalStorage())return!1;i.sidebarStatus=localStorage.getItem("sidebarStatus"),""!==i.sidebarStatus&&void 0!==i.sidebarStatus||localStorage.setItem("sidebarStatus","true"),o(),i.useTabs&&r(),n(),function(){0;"false"!==i.sidebarStatus||($('[data-toggle="sidebar"]').removeClass("in"),$(".reading-mode__content-sidebar").removeClass("in").prev().removeClass("in"))}(),setTimeout(function(){!function(){0;$(i.viewSelector).removeClass("invisible"),$(i.sidebarSelector).removeClass("invisible")}()},500),i.useAccordeon&&(t=localStorage.getItem("activePanel"),$(".panel-collapse").each(function(){$(this).removeClass("in")}),null===t&&(localStorage.setItem("activePanel","#collapseOne"),t=localStorage.getItem("activePanel")),$(t).addClass("in"),$('a[data-toggle="collapse"]').on("click",function(){var e=$(this).attr("href");localStorage.setItem("activePanel",e)})),$('[data-toggle="sidebar"]').on("click",function(){$(this).toggleClass("in"),$(this).parents(".reading-mode__content-sidebar").toggleClass("in"),$(this).parents(".reading-mode__content-sidebar").prev().toggleClass("in"),i.sidebarStatus=localStorage.getItem("sidebarStatus"),"false"===i.sidebarStatus?localStorage.setItem("sidebarStatus","true"):localStorage.setItem("sidebarStatus","false")}),$(window).on("resize",function(){o(),i.useTabs&&r(),n()}),$(window).on("orientationchange",function(){o(),i.useTabs&&r(),n()}),"undefined"!=typeof jsf&&jsf.ajax.addOnEvent(function(e){switch(e.status){case"success":o(),i.useTabs&&r(),n()}})}},e}((viewImage=function(m){"use strict";var p=!1,r="focus",n="highlight",i=null,a=null,o=null,w=[],y={},s=null;function l(e,t,o,r,n,i,a,s){p&&(console.log("------------------------------"),console.log("Overlays _createRectangle: x - "+e),console.log("Overlays _createRectangle: y - "+t),console.log("Overlays _createRectangle: width - "+o),console.log("Overlays _createRectangle: height - "+r),console.log("Overlays _createRectangle: title - "+n),console.log("Overlays _createRectangle: id - "+i),console.log("Overlays _createRectangle: group - "+a),console.log("Overlays _createRectangle: imageIndex - "+s),console.log("------------------------------")),e=m.scaleToImageSize(e),t=m.scaleToImageSize(t),o=m.scaleToImageSize(o),r=m.scaleToImageSize(r),s||(s=0);var l=m.viewer.world.getItemAt(s).imageToViewportRectangle(e,t,o,r),c={type:m.overlays.overlayTypes.RECTANGLE,rect:l,group:a,id:i,title:n};y.getOverlayGroup(c.group).hidden||S(c),w.push(c)}function S(t){p&&(console.log("viewImage.overlays._drawOverlay"),console.log("overlay: ",t));var o=document.createElement("div");$(o).attr("id","overlay_"+t.id);var e=y.getOverlayGroup(t.group);e&&(p&&console.log("overlay style",e),$(o).addClass(e.styleClass),t.type===m.overlays.overlayTypes.LINE&&function(e,t){p&&(console.log("Overlays _rotate: angle - "+e),console.log("Overlays _rotate: mapElement - "+t));if(0!==e){$(t).css("-moz-transform","rotate("+e+"deg)"),$(t).css("-webkit-transform","rotate("+e+"deg)"),$(t).css("-ms-transform","rotate("+e+"deg)"),$(t).css("-o-transform","rotate("+e+"deg)"),$(t).css("transform","rotate("+e+"deg)");var o=Math.sin(e),r=Math.cos(e);$(t).css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+r+", M12="+o+", M21=-"+o+", M22="+r+", sizingMethod='auto expand'")}}(t.angle,o),e.interactive&&(o.focus=function(e){e?($(o).addClass(r),function(o,e){if(e.title){var r=m.sizes.$container.offset(),t=$(o).offset().top,n=$(o).offset().left,i=($(o).outerHeight(),n+$(o).outerWidth()),a=$("<div class='tooltipp'>"+e.title+"</div>");$("body").append(a);var s=parseFloat(a.css("padding-top"));a.css("max-width",i-n),a.css("top",Math.max(r.top+s,t-a.outerHeight()-s)),a.css("left",Math.max(r.left+s,n)),a.attr("id","tooltip_"+e.id),m.observables.animation.do(function(){var e=Math.max($(o).offset().top,r.top),t=Math.max($(o).offset().left,r.left);a.css("top",Math.max(r.top+s,e-a.outerHeight()-s)),a.css("left",Math.max(r.left+s,t))}).takeWhile(function(){return 0<$(".tooltipp").length}).subscribe()}}(o,t)):($(o).removeClass(r),$(".tooltipp#tooltip_"+t.id).remove()),i&&i(t,e)},o.highlight=function(e){e?$(o).addClass(n):$(o).removeClass(n)},$(o).on("mouseover",function(){p&&console.log("Overlays _drawOverlay: mouse over - "+e.name),m.overlays.focusBox(t.group,t.id)}),$(o).on("mouseout",function(){p&&console.log("Overlays _drawOverlay: mouse out - "+e.name),o.focus(!1)}),$(o).on("click",function(){a&&a(t)})),t.element=o,m.viewer.addOverlay(o,t.rect,0))}function c(e,t,o){return t.x>e.x-o&&t.x<e.x+e.width+o&&t.y>e.y-o&&t.y<e.y+e.height+o}function e(e){var t=e.position,o=viewerJS.helper.detectIEVersion();o&&10===o&&(t.x+=$(window).scrollLeft(),t.y+=$(window).scrollTop());var r=m.viewer.viewport.viewerElementToViewportCoordinates(t);w.forEach(function(e){c(e.rect,r,0)?m.overlays.showOverlay(e):m.overlays.hideOverlay(e)})}return m.overlays={init:function(e){p&&(console.log("##############################"),console.log("osViewer.overlays.init"),console.log("##############################")),$.extend(!0,y,e),m.observables.overlayRemove.subscribe(function(e){e.element&&$(e.element).remove()}),y.image.highlightCoords&&m.observables.viewerOpen.subscribe(function(e){for(var t=0;t<y.image.highlightCoords.length;t++){var o=y.image.highlightCoords[t],r=o.pageIndex;m.overlays.draw(o.name,o.displayTooltip,r)}s&&s()})},onInitialized:function(e){var t=s;s=function(){t&&t(),e()}},onFocus:function(o){var r=i;i=function(e,t){r&&r(e,t),o(e,t)}},onClick:function(t){var o=a;a=function(e){o&&o(e),t(e)}},getOverlays:function(){return w.slice()},getRects:function(){return w.filter(function(e){return e.type===m.overlays.overlayTypes.RECTANGLE}).slice()},getLines:function(){return w.filter(function(e){return e.type===m.overlays.overlayTypes.LINE}).slice()},draw:function(e,t,o){p&&(console.log("osViewer.overlays.draw: group - "+e),console.log("osViewer.overlays.draw: displayTitle - "+t),console.log("osViewer.overlays.draw: imageIndex - "+o));var r=y.getCoordinates(e);if(r)for(var n=0;n<r.coordinates.length;n++){var i=r.coordinates[n],a=t&&4<i.length?i[4]:"",s=5<i.length?i[5]:n;l(i[0],i[1],i[2]-i[0],i[3]-i[1],a,s,e,o)}},unDraw:function(t){p&&console.log("osViewer.overlays.unDraw: group - "+t);w=w.filter(function(e){return e.group!==t||(m.viewer.removeOverlay(e.element),!1)})},highlight:function(t){p&&console.log("osViewer.overlays.highlight: group - "+t),w.filter(function(e){return e.group===t}).forEach(function(e){e.element&&e.element.highlight(!0)})},unHighlight:function(t){p&&console.log("osViewer.overlays.unHighlight: group - "+t),w.filter(function(e){return e.group===t}).forEach(function(e){e.element&&e.element.highlight(!1)})},focusBox:function(t,o){p&&(console.log("osViewer.overlays.highlightBox: group - "+t),console.log("osViewer.overlays.highlightBox: id - "+o)),w.filter(function(e){return e.group===t}).forEach(function(e){e.element&&e.element.focus(e.id===o)})},addOverlay:function(e){p&&console.log("osViewer.overlays.addOverlay: overlay - "+e),w.push(e),e.element&&m.viewer.updateOverlay(e.element,e.rect,0)},removeOverlay:function(e){if(e){p&&console.log("Removing overlay "+e.id);var t=w.indexOf(e);w.splice(t,1),e.element&&m.viewer.removeOverlay(e.element)}},drawRect:function(e,t,o,r){p&&(console.log("osViewer.overlays.drawRect: rectangle - "+e),console.log("osViewer.overlays.drawRect: group - "+t)),l(e.x,e.y,e.width,e.height,o||"",r||"",t)},drawLine:function(e,t,o){p&&(console.log("osViewer.overlays.drawLine: point1 - "+e),console.log("osViewer.overlays.drawLine: point2 - "+t),console.log("osViewer.overlays.drawLine: group - "+o)),function(e,t,o,r,n,i,a){p&&(console.log("------------------------------"),console.log("Overlays _createLine: x1 - "+e),console.log("Overlays _createLine: y1 - "+t),console.log("Overlays _createLine: x2 - "+o),console.log("Overlays _createLine: y2 - "+r),console.log("Overlays _createLine: title - "+n),console.log("Overlays _createLine: id - "+i),console.log("Overlays _createLine: group - "+a),console.log("------------------------------"));e=m.scaleToImageSize(e),t=m.scaleToImageSize(t),o=m.scaleToImageSize(o),r=m.scaleToImageSize(r);var s=new OpenSeadragon.Point(e,t),l=new OpenSeadragon.Point(o,r),c=s.distanceTo(l),u=function(e,t){p&&(console.log("Overlays _calculateAngle: p1 - "+e),console.log("Overlays _calculateAngle: p2 - "+t));var o=t.x-e.x,r=t.y-e.y;return 0<o?180*Math.atan(r/o)/Math.PI:o<0?180*Math.atan(r/o)/Math.PI+180:r<0?270:90}(s,l),g=(180-u)/2;t+=c/2*Math.sin(u*Math.PI/180),e-=c/2*Math.sin(u*Math.PI/180)/Math.tan(g*Math.PI/180);var v=m.viewer.viewport.imageToViewportRectangle(e,t,c,1),d=m.viewer.viewport.imageToViewportCoordinates(s),f=m.viewer.viewport.imageToViewportCoordinates(l),h={type:m.overlays.overlayTypes.LINE,rect:v,angle:u,point1:d,point2:f,group:a,id:i,title:n};y.getOverlayGroup(h.group).hidden||S(h);w.push(h)}(e.x,e.y,t.x,t.y,"","",o)},showOverlay:function(e){e&&!e.element&&(S(e),i&&i(e,!0))},hideOverlay:function(e){var t;e&&e.element&&o!=e&&(t=e,m.viewer.removeOverlay(t.element),t.element=null,i&&i(e,!1))},getOverlay:function(t,o){return w.find(function(e){return o?e.id===t&&e.group===o:e.id===t})},getCoordinates:function(e){if(p&&console.log("getCoordinates - overlay",e),e.type===m.overlays.overlayTypes.RECTANGLE){var t=m.viewer.viewport.viewportToImageRectangle(e.rect);return t=t.times(m.getScaleToOriginalSize())}if(e.type===m.overlays.overlayTypes.LINE)return{point1:m.viewer.viewport.viewportToImageCoordinates(e.poin1),point2:m.viewer.viewport.viewportToImageCoordinates(e.poin2)}},getDrawingOverlay:function(){return o},setDrawingOverlay:function(e){o=e},showHiddenOverlays:function(){m.viewer.addViewerInputHook({hooks:[{tracker:"viewer",handler:"moveHandler",hookHandler:e}]})},contains:function(e,t,o){return null==o&&(o=0),c(e,t,o)},overlayTypes:{RECTANGLE:"rectangle",LINE:"line"},getRotated:function(e){return e}},m}((viewImage=function(e){"use strict";return e.Measures=function(e){this.config=e.getConfig(),this.$container=$("#"+this.config.global.divId),this.outerCanvasSize=new OpenSeadragon.Point(this.$container.outerWidth(),this.$container.outerHeight()),this.innerCanvasSize=new OpenSeadragon.Point(this.$container.width(),this.$container.height()),this.originalImageSize=new OpenSeadragon.Point(this.getTotalImageWidth(e.getImageInfo()),this.getMaxImageHeight(e.getImageInfo())),this.footerHeight=this.config.global.footerHeight,this.rotation=null!=e.viewer?e.viewer.viewport.getRotation():0,this.xPadding=this.outerCanvasSize.x-this.innerCanvasSize.x,this.yPadding=this.outerCanvasSize.y-this.innerCanvasSize.y,this.innerCanvasSize.y-=this.footerHeight,this.fitToHeight()?this.imageDisplaySize=new OpenSeadragon.Point(this.innerCanvasSize.y/this.ratio(this.getRotatedSize(this.originalImageSize)),this.innerCanvasSize.y):this.imageDisplaySize=new OpenSeadragon.Point(this.innerCanvasSize.x,this.innerCanvasSize.x*this.ratio(this.getRotatedSize(this.originalImageSize))),this.rotated()&&(this.imageDisplaySize=this.getRotatedSize(this.imageDisplaySize))},e.Measures.prototype.getMaxImageWidth=function(e){var t=0;if(e&&0<e.length)for(var o=0;o<e.length;o++){var r=e[o];r.tileSource&&(correction=r.width,r=r.tileSource),t=Math.max(t,r.width*correction)}return t},e.Measures.prototype.getMaxImageHeight=function(e){var t=0;if(e&&0<e.length)for(var o=0;o<e.length;o++){var r=e[o],n=1;r.tileSource&&(n=r.width,r=r.tileSource),t=Math.max(t,r.height*n)}return t},e.Measures.prototype.getTotalImageWidth=function(e){var t=0;if(e&&0<e.length)for(var o=0;o<e.length;o++){var r=e[o],n=1;r.tileSource&&(n=r.width,r=r.tileSource),t+=r.width*n}return t},e.Measures.prototype.getTotalImageHeight=function(e){var t=0;if(e&&0<e.length)for(var o=0;o<e.length;o++){var r=e[o];r.tileSource&&(correction=r.width,r=r.tileSource),t+=r.height*correction}return t},e.Measures.prototype.getImageHomeSize=function(){var e=this.rotated()?1/this.ratio(this.originalImageSize):this.ratio(this.originalImageSize);if(this.fitToHeight())var t=(o=this.innerCanvasSize.y)/e;else var o=(t=this.innerCanvasSize.x)*e;return this.getRotatedSize(new OpenSeadragon.Point(t,o))},e.Measures.prototype.rotated=function(){return this.rotation%180!=0},e.Measures.prototype.landscape=function(){return this.ratio(this.originalImageSize)<1},e.Measures.prototype.ratio=function(e){return e.y/e.x},e.Measures.prototype.getRotatedSize=function(e){return new OpenSeadragon.Point(this.rotated()?e.y:e.x,this.rotated()?e.x:e.y)},e.Measures.prototype.fitToHeight=function(){return!this.config.global.adaptContainerHeight&&this.ratio(this.getRotatedSize(this.originalImageSize))>this.ratio(this.innerCanvasSize)},e.Measures.prototype.resizeCanvas=function(){this.config.global.adaptContainerHeight&&this.$container.height(this.getRotatedSize(this.imageDisplaySize).y+this.footerHeight),this.outerCanvasSize=new OpenSeadragon.Point(this.$container.outerWidth(),this.$container.outerHeight()),this.innerCanvasSize=new OpenSeadragon.Point(this.$container.width(),this.$container.height()-this.footerHeight)},e.Measures.prototype.calculateExcessHeight=function(){var e=this.getRotatedSize(this.getImageHomeSize());return this.config.global.adaptContainerHeight||this.fitToHeight()?0:.5*(this.innerCanvasSize.y-e.y)},e}((viewImage=function(n){"use strict";var i="drawing",a=!1,s=!1,l=null,c=null,u=5,g=null,v=null;function e(e){if(a)return v=n.viewer.viewport.viewerElementToViewportCoordinates(e.position),!(e.preventDefaultAction=!1)}function t(e){if(s){var t=n.viewer.viewport.viewerElementToViewportCoordinates(e.position),o=new OpenSeadragon.Rect(v.x,v.y,t.x-v.x,t.y-v.y);return t.x<v.x&&(o.x=t.x,o.width=v.x-t.x),t.y<v.y&&(o.y=t.y,o.height=v.y-t.y),n.viewer.updateOverlay(g,o,0),e.preventDefaultAction=!0}if(a&&v){var r=n.overlays.getDrawingOverlay();if(r&&n.transformRect&&n.transformRect.isActive()&&n.overlays.contains(r.rect,v,.01))v=null;else{s=!0,r&&n.overlays.removeOverlay(r),g=document.createElement("div"),l&&$(g).addClass(l.styleClass),$(g).addClass(i);o=new OpenSeadragon.Rect(v.x,v.y,0,0);n.viewer.addOverlay(g,o,1)}return e.preventDefaultAction=!0}}function o(e){if(s){s=!1;var t=n.viewer.viewport.viewerElementToViewportCoordinates(e.position),o=new OpenSeadragon.Rect(v.x,v.y,t.x-v.x,t.y-v.y);t.x<v.x&&(o.x=t.x,o.width=v.x-t.x),t.y<v.y&&(o.y=t.y,o.height=v.y-t.y),o.hitBox={l:o.x-u,t:o.y-u,r:o.x+o.width+u,b:o.y+o.height+u};var r={type:n.overlays.overlayTypes.RECTANGLE,element:g,rect:o,group:l.name};return n.overlays.setDrawingOverlay(r),c&&c(r),e.preventDefaultAction=!0}}function r(e){if(a)return e.preventDefaultAction=!0}return n.drawRect={init:function(){n.viewer.addViewerInputHook({hooks:[{tracker:"viewer",handler:"clickHandler",hookHandler:r},{tracker:"viewer",handler:"dragHandler",hookHandler:t},{tracker:"viewer",handler:"pressHandler",hookHandler:e},{tracker:"viewer",handler:"dragEndHandler",hookHandler:o}]})},startDrawing:function(e,t){a=!0,l=e,c=t},endDrawing:function(e){a=!1,c=l=null,g&&e?n.viewer.removeOverlay(g):$(g).removeClass(i)},isActive:function(){return a},isDrawing:function(){return s},removeLastDrawnElement:function(){g&&n.viewer.removeOverlay(g)}},n}((viewImage=function(r){"use strict";var n=!0,i=5,a=null,s=null;function e(e){if(n){a&&r.viewer.removeOverlay(a),(a=document.createElement("div")).style.border="2px solid green",s=r.viewer.viewport.viewerElementToViewportCoordinates(e.position),s=r.overlays.getRotated(s);var t=new OpenSeadragon.Rect(s.x,s.y,0,0);return r.viewer.addOverlay(a,t,1),e.preventDefaultAction=!0}}function t(e){if(n){var t=r.viewer.viewport.viewerElementToViewportCoordinates(e.position);t=r.overlays.getRotated(t);var o=new OpenSeadragon.Rect(s.x,s.y,t.x-s.x,t.y-s.y);return t.x<s.x&&(o.x=t.x,o.width=s.x-t.x),t.y<s.y&&(o.y=t.y,o.height=s.y-t.y),r.viewer.updateOverlay(a,o,0),e.preventDefaultAction=!0}}function o(e){if(n){var t=r.viewer.viewport.viewerElementToViewportCoordinates(e.position);t=r.overlays.getRotated(t);var o=new OpenSeadragon.Rect(s.x,s.y,t.x-s.x,t.y-s.y);return t.x<s.x&&(o.x=t.x,o.width=s.x-t.x),t.y<s.y&&(o.y=t.y,o.height=s.y-t.y),o.hitBox={l:o.x-i,t:o.y-i,r:o.x+o.width+i,b:o.y+o.height+i},e.preventDefaultAction=!0}}function l(e){if(n)return e.preventDefaultAction=!0}return r.drawLine={init:function(){r.viewer.addViewerInputHook({hooks:[{tracker:"viewer",handler:"clickHandler",hookHandler:l},{tracker:"viewer",handler:"scrollHandler",hookHandler:l},{tracker:"viewer",handler:"dragHandler",hookHandler:t},{tracker:"viewer",handler:"pressHandler",hookHandler:e},{tracker:"viewer",handler:"dragEndHandler",hookHandler:o}]})},toggleDrawing:function(){n=!n}},r}((viewImage=function(n){"use strict";function i(e){return"number"==typeof e&&!Number.isNaN(e)}return n.controls.persistence={init:function(e){if("undefined"!=typeof Storage){var t=null,o=n.getConfig().global.persistenceId;if(e.global.persistZoom||e.global.persistRotation){try{t=JSON.parse(localStorage.imageLocation)}catch(e){0}t&&(i((r=t).x)&&i(r.y)&&i(r.zoom)&&i(r.rotation))&&t.persistenceId===o&&(e.image.location={},e.global.persistZoom&&(e.image.location.zoom=t.zoom,e.image.location.x=t.x,e.image.location.y=t.y),e.global.persistRotation?e.image.location.rotation=t.rotation:e.image.location.rotation=0),window.onbeforeunload=function(){var e=n.controls.getLocation();e.persistenceId=n.getConfig().global.persistenceId,localStorage.imageLocation=JSON.stringify(e)}}}var r}},n}((viewImage=function(o){"use strict";var t=!1,e=null;return o.controls={init:function(e){o.controls.persistence&&o.controls.persistence.init(e),o.observables&&(o.observables.redrawRequired.sample(o.observables.viewportUpdate).filter(function(e){return!!o.controls}).subscribe(function(e){!function(e,t){0;t.viewer.viewport.minZoomLevel=t.viewer.viewport.getHomeZoom()*t.getConfig().global.minZoomLevel;var o=e.targetLocation.zoom,r=new OpenSeadragon.Point(e.targetLocation.x,e.targetLocation.y);o*t.viewer.viewport.getHomeZoom()-t.viewer.viewport.minZoomLevel<.001||!o?t.controls.goHome(!0):(t.viewer.viewport.zoomTo(o*t.controls.getCurrentRotationZooming(),null,!0),t.controls.setCenter(r));"open"===e.osState&&0!==e.targetLocation.rotation&&t.controls.rotateTo(e.targetLocation.rotation)}(e,o),o.controls.setPanning(!1)}),o.observables.viewerZoom.subscribe(function(e){o.controls.isPanning()||o.viewer.viewport.getZoom()<=o.viewer.viewport.minZoomLevel&&(o.controls.setPanning(!0),o.controls.goHome(!0),o.controls.setPanning(!1))})),0<$("#fullscreenTemplate").length&&($("#fullscreenTemplate").on("mousemove",function(){o.controls.fullscreenControlsFadeout()}),$("#fullscreenMap").on("touchmove",function(){o.controls.fullscreenControlsFadeout()}).on("touchend",function(){o.controls.fullscreenControlsFadeout()}))},getLocation:function(){return{x:o.controls.getCenter().x,y:o.controls.getCenter().y,zoom:o.controls.getZoom()/o.controls.getCurrentRotationZooming(),rotation:o.controls.getRotation()}},getCenter:function(){return o.viewer.viewport.getCenter(!0)},setCenter:function(e){o.viewer.viewport.panTo(e,!0)},getZoom:function(){return o.viewer.viewport.getZoom(!0)},zoomTo:function(e){var t=parseFloat(e)/o.viewer.viewport.getZoom();o.viewer.viewport.zoomBy(t,o.viewer.viewport.getCenter(!1),!0)},setFullScreen:function(e){o.viewer.setFullScreen(e)},goHome:function(e){o.viewer.viewport.goHome(e),!0},reset:function(e){o.controls.goHome(!0),o.viewer.viewport.zoomTo(o.viewer.viewport.getHomeZoom(),null,!0),e&&o.controls.rotateTo(0)},zoomIn:function(){o.viewer.viewport.zoomBy(o.getConfig().global.zoomSpeed,o.viewer.viewport.getCenter(!1),!1)},zoomOut:function(){o.viewer.viewport.zoomBy(1/o.getConfig().global.zoomSpeed,o.viewer.viewport.getCenter(!1),!1)},getHomeZoom:function(e){e&&o.getCanvasSize().x/o.getCanvasSize().y<=o.getImageSize().x/o.getImageSize().y&&(o.viewer.viewport.homeFillsViewer=!0);var t=o.viewer.viewport.getHomeZoom();return o.viewer.viewport.homeFillsViewer=!1,t},rotateRight:function(){var e=o.viewer.viewport.getRotation()+90;o.controls.rotateTo(e)},rotateLeft:function(){var e=o.viewer.viewport.getRotation()-90;o.controls.rotateTo(e)},getRotation:function(){return o.viewer.viewport.getRotation()},setRotation:function(e){return o.controls.rotateTo(e)},rotateTo:function(e){e<0&&(e+=360),e%=360,t=!0,null,o.viewer.viewport.setRotation(e),t=!1},getCurrentRotationZooming:function(){var e=o.getSizes();return e&&e.rotated()?1/e.ratio(e.originalImageSize):1},setPanning:function(e){t=e},isPanning:function(){return t},fullscreenControlsFadeout:function(){e&&(clearTimeout(e),this.showFullscreenControls()),e=setTimeout(this.hideFullscreenControls,3e3)},hideFullscreenControls:function(){$("#fullscreenRotateControlsWrapper, #fullscreenZoomSliderWrapper, #fullscreenExitWrapper, #fullscreenPrevWrapper, #fullscreenNextWrapper").stop().fadeOut("slow")},showFullscreenControls:function(){$("#fullscreenRotateControlsWrapper, #fullscreenZoomSliderWrapper, #fullscreenExitWrapper, #fullscreenPrevWrapper, #fullscreenNextWrapper").show()}},o}(viewImage||{},jQuery))||{},jQuery))||{},jQuery))||{},jQuery))||{},jQuery))||{},jQuery))||{},jQuery))||{},jQuery))||{},jQuery))||{},jQuery);
//# sourceMappingURL=viewImage.min.js.map